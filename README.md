# ML решение задачи о свободных колебаниях груза
## Описание 
Проект реализует различные подходы машинного обучения для решения задачи о свободных колебаниях груза с боковыми амортизаторами.
<center>

![alt text](image.png)

</center>
Данные из условия:

```
m = 2.4e3;          % Масса груза, кг
mu1 = 8.3e5;        % Коэффициент вязкого трения, Н*с/м
k1 = 2.3e5;         % Коэффициент упругости 1, Н/м
k2 = 8.0e4;         % Коэффициент упругости 2, Н/м
|v_M'(0)| = 0.9;    % Начальная скорость, м/с
gamma = 0.27;       % Коэффициент рассогласования
```

# Структура проекта

├── data # Генерация и загрузка данных\
├── models # ML модели (PINN, традиционные ML, LSTM)\
├── physics # Физическая модель и ОДУ\
├── utils # Вспомогательные функции\
├── examples # Примеры использования\
└── main.py # Основной скрипт

## Установка необходимых библиотек

```bash
pip install -r requirements.txt
```
## Запуск
```bash
python main.py --mode compare --model all --epochs 1000
```
# Физическая интерпретация

Груз массы m подвешен на вертикальной пружине с жесткостью $k_1$ и имеет боковые амортизаторы с жесткостью $k_2$ и демпфированием $\mu_1$. Движение рассматривается в плоскости. На груз действуют:
* Сила тяжести $mg$
* Сила упругости вертикальной пружины $-k_1y$
* Сила упругости боковых амортизаторов $-k_2x$
* Сила вязкого трения $-\mu_1v$ (пропорциональна скорости)

### Математическая модель
Уравнения движения в проекциях на оси x и y (горизонталь и вертикаль):\
По оси x (горизонталь):
$$
m\ddot{x} = -k_2 x-\mu_1 \dot{x}
$$
По оси y (вертикаль):
$$
m\ddot{y} = -k_1 y-\mu_1 \dot{y} - mg
$$

### Приведение к системе ОДУ первого порядка
Введем переменные:
$$
    v_x=\dot{x}, v_y=\dot{y}
$$
Тогда система примет вид:
$$
\begin{cases}
\dot{x}=v_x\\
\dot{v}_x=-\frac{k_1}{m} x-\frac{\mu_1}{m} v_x\\
\dot{y}=v_y\\
\dot{v}_y=-\frac{k_1}{m} y-\frac{\mu_1}{m} v_y-g\\
\end{cases}
$$
### Начальные условия 
Используем коэффициент рассогласования gamma для начального положения. Начальная скорость задана: $v_M'(0) = 0.9 м/с$. Предположим, что начальная скорость направлена по горизонтали (ось x).
Начальные условия:
$$
x(0)=\gamma x^*(0), v_x(0)=0.9,\\
y(0)=\gamma y^*(0), v_y(0)=0,\\
$$
где $x^*(0)$ и $y^*(0)-$ установившиеся положения, которые можно найти из условия равновесия.

Из условия равновесия:
$$
-k_2 x^* = 0 ⇒ x^* = 0 \\
-k_1 y^* - m g = 0 ⇒ y^* = -\frac{m g}{k_1}\\
$$ 

Таким образом:
$$
x(0)=\gamma*0=0\\
y(0)=\gamma*(-\frac{m g}{k_1})=-0.27*\frac{2400*9.81}{2.3*10^5} ≈ -0.0276 м
$$
# Методы решения
## Physics-Informed Neural Networks (PINN)
PINN - это гибридный подход, объединяющий нейронные сети с физическими законами.
### Принцип работы
Нейросеть принимает время $t$ и параметры системы, возвращает состояние $[x, v_x, y, v_y]$.\
Автоматическое дифференцирование вычисляет производные и проверяет выполнение уравнений ОДУ.\
Комбинирует невязку уравнений и начальные условия.
## ML модели
ML подход обучается на данных, сгенерированных численными методами.
### Принцип работы
Решение ОДУ методом Рунге-Кутты для различных параметров.\
Нейросеть учится предсказывать $[x, v_x, y, v_y]$ по входным признакам $[t, m, \mu_1, k_1, k_2, \gamma, v_0, g]$
# Результаты
![alt text](Figure_2.png)
#### Конечные положения:
Численный: x=0.0010, y=-0.0977\
PINN:      x=-0.0099, y=-0.0860\
ML:        x=0.0009, y=-0.0997